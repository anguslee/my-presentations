\documentclass{beamer}
% Replace the \documentclass declaration above
% with the following two lines to typeset your 
% lecture notes as a handout:
%\documentclass[handout]{beamer}
\usepackage{CJKutf8}
\usepackage[T1]{fontenc}
%\usepackage[utf8x]{inputenc}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{mathtools}
\usepackage{ulem}
\usepackage{url}
\usepackage{pifont}
\usepackage{pgfplots}
\usepackage{textcomp}

\usepgfplotslibrary{external}
\pgfplotsset{width=10cm,compat=1.9}

%% \usepackage{tikz}
%% \usepackage{verbatim}
%% \usepackage[active,tightpage]{preview}
%% \PreviewEnvironment{center}
%% \setlength\PreviewBorder{10pt}

\usetikzlibrary{shapes,arrows}

\tikzexternalize
\everymath{\displaystyle}

% There are many different themes available for Beamer. A comprehensive
% list with examples is given here:
% http://deic.uab.es/~iblanes/beamer_gallery/index_by_theme.html
% You can uncomment the themes below if you would like to use a different
% one:
%\usetheme{AnnArbor}
%\usetheme{Antibes}
%\usetheme{Bergen}
%\usetheme{Berkeley}
%\usetheme{Berlin}
%\usetheme{Boadilla}
%\usetheme{boxes}
%\usetheme{CambridgeUS}
%\usetheme{Copenhagen}
%\usetheme{Darmstadt}
%\usetheme{default}
%\usetheme{Frankfurt}
%\usetheme{Goettingen}
%\usetheme{Hannover}
%\usetheme{Ilmenau}
%\usetheme{JuanLesPins}
%\usetheme{Luebeck}
%\usetheme{Madrid}
%\usetheme{Malmoe}
%\usetheme{Marburg}
%\usetheme{Montpellier}
%\usetheme{PaloAlto}
%\usetheme{Pittsburgh}
%\usetheme{Rochester}
%\usetheme{Singapore}
%\usetheme{Szeged}
\usetheme{Warsaw}

%% \newcommand{chartnumproducts} {
%% }

\makeatletter
\pgfdeclareshape{datastore}{
  \inheritsavedanchors[from=rectangle]
  \inheritanchorborder[from=rectangle]
  \inheritanchor[from=rectangle]{center}
  \inheritanchor[from=rectangle]{base}
  \inheritanchor[from=rectangle]{north}
  \inheritanchor[from=rectangle]{north east}
  \inheritanchor[from=rectangle]{east}
  \inheritanchor[from=rectangle]{south east}
  \inheritanchor[from=rectangle]{south}
  \inheritanchor[from=rectangle]{south west}
  \inheritanchor[from=rectangle]{west}
  \inheritanchor[from=rectangle]{north west}
  \backgroundpath{
    %  store lower right in xa/ya and upper right in xb/yb
    \southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
    \northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
    \pgfpathmoveto{\pgfpoint{\pgf@xa}{\pgf@ya}}
    \pgfpathlineto{\pgfpoint{\pgf@xb}{\pgf@ya}}
    \pgfpathmoveto{\pgfpoint{\pgf@xa}{\pgf@yb}}
    \pgfpathlineto{\pgfpoint{\pgf@xb}{\pgf@yb}}
 }
}
\makeatother


\begin{document}

\newcommand{\plotNumEngineerChart}[1][,] {
  \begin{tikzpicture}[#1]
    \begin{axis}[
        title={团队开发成员数量变化},
        xlabel={年份},
        ylabel={团队开发成员数},
        xmin=2012, xmax=2015,
        ymin=0, ymax=20,
        xtick={2012,2013,2014,2015},
        ytick={0,5,10,15,20},
        legend pos=north west,
        ymajorgrids=true,
        grid style=dashed,
      ]
      
      \addplot[
        color=blue,
        mark=square,
      ]
      coordinates {
        (2012,7)(2013,9)(2014,13)(2015,11)
      };
      \legend{度假搜索团队规模}
    \end{axis}
  \end{tikzpicture}
}

\newcommand{\plotNumProductGrowthChart}[1][,] {
  \begin{tikzpicture}[#1]
    \begin{axis}[
        title={产品规模随时间的演变趋势},
        xlabel={年份},
        ylabel={度假搜索覆盖的单品数量（万）},
        xmin=2012, xmax=2015,
        ymin=0, ymax=120,
        xtick={2012,2013,2014,2015},
        ytick={0,20,40,60,80,100,120},
        legend pos=north west,
        ymajorgrids=true,
        grid style=dashed,
      ]
      
      \addplot[
        color=blue,
        mark=square,
      ]
      coordinates {
        (2012,10)(2013,29.5)(2014,59.5)(2015,108.4)
      };
      \legend{旅游度假产品数}
    \end{axis}
  \end{tikzpicture}
}

\newcommand{\plotGMVGrowthChart}[1][,] {
  \begin{tikzpicture}[#1]
    \begin{axis}[
        title={GMV随时间的演变趋势},
        xlabel={年份},
        ylabel={日均GMV（万）},
        xmin=2012, xmax=2015,
        ymin=0, ymax=1200,
        xtick={2012,2013,2014,2015},
        ytick={0,200,400,600,800,1000,1200},
        legend pos=north west,
        ymajorgrids=true,
        grid style=dashed,
      ]
      
      \addplot[
        color=blue,
        mark=square,
      ]
      coordinates {
        (2012,25)(2013,130)(2014,500)(2015,950)
      };
      \legend{旅游度假事业部日均GMV}
    \end{axis}
  \end{tikzpicture}
}


\begin{CJK}{UTF8}{gbsn}

\title{度假搜索系统的构建－原则与经验}

% A subtitle is optional and this may be deleted
\subtitle{2016年Q2晋级述职答辩}

\author{李庚\inst{1}}
% - Give the names in the same order as the appear in the paper.
% - Use the \inst{?} command only if the authors have different
%   affiliation.

\institute[Qunar.com] % (optional, but mostly needed)
{
  \inst{1}
  旅游度假事业部－搜索及频道 \\
  Qunar.com
}
% - Use the \inst command only if there are several affiliations.
% - Keep it simple, no one is interested in your street address.

\date{\today}

\AtBeginSection[]
{
  \begin{frame}<beamer>{纲要}
    \tableofcontents[currentsection,currentsubsection]
  \end{frame}
}

\AtBeginSubsection[]
{
  \begin{frame}<beamer>{纲要}
    \tableofcontents[currentsection,currentsubsection]
  \end{frame}
}


\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{自我介绍}
  \begin{columns}
    \column{0.4\textwidth}
    \begin{itemize}
      \item { 李庚 }
      \item { 2010年7月毕业，同年入职 }
    \end{itemize}
    \column{0.6\textwidth}
    \begin{itemize}[1]
      \item 度假搜索系统技术Leader
      \item QTalk Code Contributor, Emacs版QTalk开发者与维护者
    \end{itemize}
  \end{columns}  
\end{frame}

\begin{frame}{自我介绍（续）}
  \begin{itemize}
  \item {度假搜索系统技术Leader \& 搜索系统产品需求规划}
  \end{itemize}
  \vspace{3 mm}
  \begin{columns}
    \column{0.6\textwidth}
    \includegraphics[scale=0.15]{./images/pc-search-screenshot}
    \column{0.4\textwidth}
    \includegraphics[scale=0.2]{./images/mobile-search-screenshot}
  \end{columns}
\end{frame}

\begin{frame}{自我介绍（续）}
  \begin{itemize}
  \item {QTalk Code Contributor, Emacs版QTalk开发者与维护者}
  \end{itemize}
  \begin{center}
    \includegraphics[scale=0.3]{./images/qtalk-emacs-screenshot}
  \end{center}
\end{frame}

\begin{frame}{纲要}
  \tableofcontents
\end{frame}

\section{搜索系统在业务中的定位}


\begin{frame}{事业部的目标}
  \begin{itemize}
  \item { 整合不同供应商提供的各类产品，满足用户的出行需求。
    \begin{itemize}
      \item<2-> { GMV: Gross Merchandise Value，总交易额 }
      \item<2-> { 毛利：$GMV - \text{成本} $ }
    \end{itemize}
  }
  \end{itemize}
\end{frame}

\begin{frame}{搜索系统概况}
  \begin{itemize}
  \item { 独立产品数：120万 }
  \item { 支持日均GMV：950万 }
  \item { 日均搜索PV：150万 }
  \item { 日均搜索用户UV：15万 }
  \end{itemize}
\end{frame}


\section{工作核心原则与方法}

\begin{frame}{如何做到？}
  \begin{enumerate}
    \item { 随着业务量的膨胀，搜索服务的质量和效率不能降低 }
  \end{enumerate}
  %% \uncover<2-> {
    \begin{center}
      \plotGMVGrowthChart[scale=0.65]
    \end{center}
  %%}
\end{frame}

\subsection{高效支持业务需求}

\begin{frame}{系统设计原则}
  \begin{enumerate}
    \item {目标：快速响应需求，降低故障概率}
    \item {可用性保障：选择适合的技术实现不同的系统组成部分}
    \item {性能保障：API百ms级，产品更新处理分钟级，挖掘计算小时级}
  \end{enumerate}
\end{frame}

\begin{frame}{搜索系统技术结构}
  \begin{center}
    \begin{tikzpicture}[
        font=\sffamily,
        every matrix/.style={ampersand replacement=\&,column sep=1cm,row sep=.3cm},
        source/.style={draw,thick,rounded corners,fill=yellow!20,inner sep=.1cm},
        process/.style={draw,thick,circle,fill=blue!20},
        sink/.style={source,fill=green!20},
        datastore/.style={draw,very thick,shape=datastore,inner sep=.1cm},
        dots/.style={gray,scale=1},
        to/.style={->,>=stealth',shorten >=1pt,semithick,font=\sffamily\footnotesize},
        every node/.style={align=center}]

      % Position the nodes using a matrix layout
      \matrix{
        \node[source] (productsource) {旅游度假产品数据源}; \&
        \node[datastore] (index) {倒排索引}; \&
        \node[sink] (frontend) {度假搜索前端};  \\

        \node[process] (crawling) {抓取打包}; \& 
        \node[process] (searchengine) {搜索引擎}; \&
        \node[process] (webapi) {Web API\\搜索服务}; \\

        \node[datastore] (rawstorage) {产品原始数据}; \&
        \node[process] (preprocess) {预处理、\\数据挖掘}; \&
        \node[datastore] (processedstorage) {搜索服务数据}; \\
      };

      % Draw the arrows between the nodes and label them.
      \draw[to] (productsource) -- (crawling);
      \draw[to] (crawling) -- (rawstorage);
      \draw[to] (rawstorage) -- (preprocess);
      \draw[to] (preprocess) -- (searchengine);
      \draw[to] (searchengine) to[bend right=60] (index);
      \draw[to] (index) to[bend right=60] (searchengine);
      \draw[to] (searchengine) -- (webapi);
      \draw[to] (webapi) -- (frontend);
      \draw[to] (preprocess) to[bend right=40] (processedstorage);
      \draw[to] (processedstorage) to[bend right=40] (preprocess);
      \draw[to] (webapi) -- (processedstorage);
      \draw[to] (processedstorage) -- (webapi);
    \end{tikzpicture}
  \end{center}
\end{frame}

\begin{frame}{搜索系统技术结构（续）}
  \begin{block}{对外服务端}
    \begin{itemize}
    \item { Web API搜索服务 }
    \item { 搜索引擎 }
    \end{itemize}
  \end{block}
  \begin{block}{后台处理}
    \begin{itemize}
    \item { 抓取打包 }
    \item { 预处理 }
    \item { 数据挖掘 }
    \end{itemize}
  \end{block}
\end{frame}

\begin{frame}{技术结构上保证搜索服务的效率}
  %% $$ GMV = \sum_{i \in S}{(UV_i \times {\color{blue}{A_i}} \times {\color{blue}{R_i}} \times {\color{blue}{M_i}})} $$
  \begin{columns}
    \column{0.4\textwidth}
    \begin{itemize}
    \item {
      对外服务：
      \begin{enumerate}
      \item { 高可用性（跨机房） }
      \item { 低访问延时（无cache） }
      \item { 横向扩展 }
      \end{enumerate}
    }
    \item {
      后台数据处理：
      \begin{enumerate}
      \item { 高吞吐率 }
      \item { 数据更新及时 }
      \end{enumerate}
    }
    \end{itemize}
    \column{0.6\textwidth}
    \plotNumProductGrowthChart[scale=0.6]
  \end{columns}
\end{frame}

\begin{frame}{Case 1: Web API搜索服务结构优化}
  早期：可用性差，访问延时高；易出故障，维护成本高。
    \begin{center}
    \begin{tikzpicture}[
        font=\sffamily,
        every matrix/.style={ampersand replacement=\&,column sep=1cm,row sep=.3cm},
        source/.style={draw,thick,rounded corners,fill=yellow!20,inner sep=.1cm},
        process/.style={draw,thick,circle,fill=blue!20},
        sink/.style={source,fill=green!20},
        datastore/.style={draw,very thick,shape=datastore,inner sep=.1cm},
        dots/.style={gray,scale=1},
        to/.style={->,>=stealth',shorten >=1pt,semithick,font=\sffamily\footnotesize},
        every node/.style={align=center},
      ]

      % Position the nodes using a matrix layout
      \matrix{
        \node[datastore] (index) {倒排索引(Lucene)}; \&
        \node[sink] (frontend) {度假搜索前端};  \\

        \node[process] (searchengine) {搜索引擎}; \&
        \node[process] (webapi) {Web API\\搜索服务}; \\

        \node[process] (preprocess) {预处理、\\数据挖掘}; \&
        \node[datastore] (processedstorage) {搜索服务数据\\(RDBMS)}; \\
      };

      % Draw the arrows between the nodes and label them.
      \draw[to] (preprocess) -- (searchengine);
      \draw[to] (searchengine) to[bend right=60] (index);
      \draw[to] (index) to[bend right=60] (searchengine);
      \draw[to] (searchengine) -- (webapi);
      \draw[to] (webapi) -- (frontend);
      \draw[to] (preprocess) to[bend right=40] (processedstorage);
      \draw[to] (processedstorage) to[bend right=40] (preprocess);
      \draw[to] (webapi) -- (processedstorage);
      \draw[to] (processedstorage) -- (webapi);
    \end{tikzpicture}
  \end{center}
\end{frame}

\begin{frame}{优化原则}
  \begin{enumerate}
  \item { 相对外部IO访问次数，API时间复杂度控制在O(1) }
  \item { 尊重墨菲定律。从底层结构上保证无单点依赖，且能够横向扩展 }
  \item { 不同的子系统之间在服务部署上分离，避免因竞争计算资源导致相互阻塞 }
  \item { 将保险机制内建入接口设计中：过期数据优于空结果，降低P1故障发生几率 }
  \end{enumerate}
\end{frame}


\begin{frame}{系统结构改进}
  \begin{center}
    \begin{tikzpicture}[
        font=\sffamily,
        every matrix/.style={ampersand replacement=\&,column sep=1cm,row sep=.3cm},
        source/.style={draw,thick,rounded corners,fill=yellow!20,inner sep=.1cm},
        process/.style={draw,thick,circle,fill=blue!20},
        sink/.style={source,fill=green!20},
        datastore/.style={draw,very thick,shape=datastore,inner sep=.1cm},
        dots/.style={gray,scale=1},
        to/.style={->,>=stealth',shorten >=1pt,semithick,font=\sffamily\footnotesize},
        every node/.style={align=center},
      ]

      % Position the nodes using a matrix layout
      \matrix{
        \node[datastore] (index) {倒排索引(Lucene)}; \&
        \node[sink] (frontend) {度假搜索前端};  \& \\

        \node[process] (searchengine) {搜索引擎}; \&
        \node[process] (webapi) {Web API\\搜索服务}; \&
        \node[datastore] (kvengine) {Cassandra\\分布式存储}; \\

        \node[datastore] (offlinestorage) {离线数据\\RDBMS+REDIS}; \&
        \node[process] (preprocess) {预处理、\\数据挖掘}; \&
        \node[datastore] (processedstorage) {服务数据\\RDBMS}; \\
      };

      % Draw the arrows between the nodes and label them.
      \draw[to] (preprocess) -- (searchengine);
      \draw[to] (searchengine) to[bend right=60] (index);
      \draw[to] (index) to[bend right=60] (searchengine);
      \draw[to] (searchengine) -- (webapi);
      \draw[to] (webapi) -- (frontend);
      \draw[to] (preprocess) -- (processedstorage);
      % \draw[to] (processedstorage) to[bend right=40] (preprocess);
      \draw[to] (preprocess) to[bend right=20] (offlinestorage);
      \draw[to] (offlinestorage) to[bend right=20] (preprocess);
      \draw[to] (preprocess) -- (kvengine);
      \draw[to] (kvengine) -- (preprocess);
      \draw[to] (webapi) -- (kvengine);
      \draw[to] (kvengine) -- (webapi);
      \draw[to] (processedstorage) -- (webapi);
    \end{tikzpicture}
  \end{center}
\end{frame}


\subsection{抓住搜索服务的本质}

\begin{frame}{搜索服务的质量的量化定义}
  $$ GMV = \sum_{i \in S}{(UV_i \times A_i \times R_i \times M_i)} $$
  \begin{itemize}
  \item { UV: 独立用户访问量 }
  \item { \color{blue}{ A: 服务可用率 } }
  \item { \color{blue}{ R: UV至订单转化率 } }
  \item { \color{blue}{ M: 平均用户交易额 } }
  \item { S: 访问来源 }
  \end{itemize}
\end{frame}

\begin{frame}{When Low-Hanging Fruits Ran Out}
  \begin{center}
    \plotNumProductGrowthChart[scale=0.7]
  \end{center}
\end{frame}

\begin{frame}{When Low-Hanging Fruits Ran Out}
  \begin{center}
    \plotGMVGrowthChart[scale=0.7]
  \end{center}
\end{frame}

\begin{frame}{需求精细化：度量一切}
  \begin{itemize}
  \item { 接口的访问量与响应时间 }
  \item { 用户的行为：转化率，点击分布等等 }
  \item { 用户的意向追踪：qchat聊天记录分析 }
  \end{itemize}
\end{frame}

\begin{frame}{Case 2: 倒排索引系统的内存使用优化}
  \begin{itemize}
    \item {搜索排序数据占用越来越多的内存}
    \item {平均响应时间较好，但FGC发生时搜索API平均响应时间急剧恶化}
    \item {优化：写入外存，利用操作系统的Page Cache保证访问性能}
  \end{itemize}
  %% \uncover<2-> {
  \begin{center}
    \includegraphics[scale=0.3]{./images/searchengine-fullgc}
  \end{center}
  \begin{itemize}
  \item {响应时间：150ms \ding{213} 60ms，波动趋于稳定}
    %% {http://cerberus.corp.qunar.com/full_new_metric.htm?appCode=vs_vacation_api&name=query_qsearch_time}
  \end{itemize}
  %% }
\end{frame}

\begin{frame}{Case 3: UV维度s-d转化率优化（进行中）}
  \begin{itemize}
  \item {搜索来源分析}
  \item {用户行为分布情况分析}
  \item {反馈数据迅速体现在推荐导航中}
  \end {itemize}
  \begin{center}
    \includegraphics[scale=0.6]{./images/brexit-hit}
  \end{center}
\end{frame}

\begin{frame}{Case 4: 小流量测试环境构建}
  \begin{center}
    \begin{tikzpicture}[
        font=\sffamily,
        every matrix/.style={ampersand replacement=\&,column sep=1cm,row sep=.3cm},
        source/.style={draw,thick,rounded corners,fill=yellow!20,inner sep=.1cm},
        process/.style={draw,thick,circle,fill=blue!20},
        sink/.style={source,fill=green!20},
        datastore/.style={draw,very thick,shape=datastore,inner sep=.1cm},
        dots/.style={gray,scale=1},
        to/.style={->,>=stealth',shorten >=1pt,semithick,font=\sffamily\footnotesize},
        every node/.style={align=center},
      ]

      % Position the nodes using a matrix layout
      \matrix{
        \&
        \node[sink] (frontend) {度假搜索前端};  \& \\

         \& \node[process] (webapi) {Web API\\搜索服务};
         \& \node[process] (uidhash) {UID \\Hash}; \\

        \node[datastore] (accessrecords) {用户行为日志\\（原始）}; \&
        \node[datastore] (accessrecords) {用户行为日志\\（对照）}; \\
      };

      % Draw the arrows between the nodes and label them.
      \draw[to] (webapi) -- (frontend);
      \draw[to] (uidhash) -- (frontend);
    \end{tikzpicture}
  \end{center}
\end{frame}

%% \begin{frame}{Case 5: 小流量测试环境构建}
%%   似易实难
%%   \begin{itemize}
%%     \item { 环境调试困难，涉及的合作方比较多：前端、数据统计、交易系统、无线端等 }
%%     \item { 统计、外投等环节难免不规范 }
%%     \item { 获取评估结果的周期较长 }
%%   \end{itemize}
%% \end{frame}


\subsection{形成规范的开发流程体系}

\begin{frame}{重视需求Review}
  \begin{itemize}
  \item {目标}
  \item {依据}
  \item {结果度量方法}
  \end{itemize}
\end{frame}

\subsection{保持团队稳定}

\begin{frame}{硬币的另一面}
  $ {\color{blue}{\text{毛利}}} = GMV - \color{blue}{\text{成本}} $
  \begin{center}
    \plotGMVGrowthChart[scale=0.6]
  \end{center}
\end{frame}

\begin{frame}{成本：开发资源与计算资源}
  \begin{center}
    \plotNumEngineerChart[scale=0.7]
  \end{center}
\end{frame}


%% \begin{frame}{搜索团队要应对的问题（续）}
%%   \begin{enumerate}\setcounter{enumi}{1}
%%   \item {
%%     应对不断变化的需求模式
%%     \begin{itemize}
%%       \item { 单纯点击反馈排名 \ding{213} 竞价排名 }
%%       \item { 重视规模 \ding{213} 重视效果 }
%%     \end{itemize}
%%   }
%%   \end{enumerate}
%% \end{frame}



%% \begin{frame}{功能实现原则}
%%   \begin{itemize}
%%     \item { Amdahl's Law: Make the common case fast. }
%%     \item { Do not reinvent the wheel. }
%%   \end{itemize}
%% \end{frame}

%% \begin{frame}{Case 2: 竞价排名系统结构的简化}
%%   \begin{center}
%%     \begin{tikzpicture}[
%%         font=\sffamily,
%%         every matrix/.style={ampersand replacement=\&,column sep=1cm,row sep=.3cm},
%%         source/.style={draw,thick,rounded corners,fill=yellow!20,inner sep=.1cm},
%%         process/.style={draw,thick,circle,fill=blue!20},
%%         sink/.style={source,fill=green!20},
%%         datastore/.style={draw,very thick,shape=datastore,inner sep=.1cm},
%%         dots/.style={gray,scale=1},
%%         to/.style={->,>=stealth',shorten >=1pt,semithick,font=\sffamily\footnotesize},
%%         every node/.style={align=center},
%%       ]

%%       % Position the nodes using a matrix layout
%%       \matrix{
%%         \node[datastore] (vpasdatastore) {竞价系统数据}; \&
%%         \node[process] (searchengine) {搜索引擎};  \& \\

%%         \node[process] (vpasapi) {竞价系统\\API}; \&
%%         \node[process] (webapi) {Web API\\搜索服务}; \&
%%         \node[sink] (frontend) {度假搜索前端}; \& \\

%%         \node[process] (preprocess) {预处理}; \&
%%         \node[process] (vpasadaptors) {竞价投放}; \&
%%         \\
%%       };

%%       % Draw the arrows between the nodes and label them.
%%       \draw[to] (searchengine) -- (webapi);
%%       \draw[to] (preprocess) -- (vpasapi);
%%       \draw[to] (vpasapi) to[bend right=40] (vpasdatastore);
%%       \draw[to] (vpasdatastore) to[bend right=40] (vpasapi);
%%       \draw[to] (vpasapi) -- (webapi);
%%       \draw[to] (webapi) -- (vpasadaptors);
%%       \draw[to] (vpasadaptors) -- (vpasapi);
%%       \draw[to] (vpasadaptors) -- (preprocess);
%%       \draw[to] (webapi) -- (frontend);
%%     \end{tikzpicture}
%%   \end{center}
%% \end{frame}

%% \begin{frame}{Case 2: 竞价排名系统结构的简化}
%%   \begin{center}
%%     \begin{tikzpicture}[
%%         font=\sffamily,
%%         every matrix/.style={ampersand replacement=\&,column sep=1cm,row sep=.3cm},
%%         source/.style={draw,thick,rounded corners,fill=yellow!20,inner sep=.1cm},
%%         process/.style={draw,thick,circle,fill=blue!20},
%%         sink/.style={source,fill=green!20},
%%         datastore/.style={draw,very thick,shape=datastore,inner sep=.1cm},
%%         dots/.style={gray,scale=1},
%%         to/.style={->,>=stealth',shorten >=1pt,semithick,font=\sffamily\footnotesize},
%%         every node/.style={align=center},
%%       ]

%%       % Position the nodes using a matrix layout
%%       \matrix{
%%         \node[datastore] (vpasdatastore) {竞价系统数据\\倒排索引数据}; \&
%%         \node[process] (searchengine) {搜索引擎};  \& \\

%%         \&
%%         \node[process] (webapi) {竞价/Web\\API}; \&
%%         \node[sink] (frontend) {度假搜索前端}; \& \\

%%         \node[process] (preprocess) {预处理}; \&
%%         \node[process] (vpasadaptors) {竞价投放}; \&
%%         \\
%%       };

%%       % Draw the arrows between the nodes and label them.
%%       \draw[to] (searchengine) -- (webapi);
%%       \draw[to] (webapi) -- (vpasadaptors);
%%       \draw[to] (vpasadaptors) -- (vpasdatastore);
%%       \draw[to] (vpasdatastore) -- (searchengine);
%%       \draw[to] (vpasadaptors) -- (preprocess);
%%       \draw[to] (preprocess) -- (vpasdatastore);
%%       \draw[to] (webapi) -- (frontend);
%%     \end{tikzpicture}
%%   \end{center}
%% \end{frame}


%% \begin{frame}{简化带来的好处}
%%   \begin{itemize}
%%   \item {减少调用层级}
%%   \item {竞价产品保持与搜索、筛选相同的逻辑，易于维护}
%%   \end{itemize}
%% \end{frame}



\section{经验总结}


\begin{frame}{基本原则}
  $$ GMV = \sum_{i \in S}{(UV_i \times A_i \times R_i \times M_i)} $$
  \begin{enumerate}
  \item {
    量化核心目标：
    \begin{itemize}
    \item { 产品需求：明确的量化指标和评测方法； }
    \item { 技术需求：制定监控目标，总结效果； }
    \end{itemize}
  }
  \item {
    重视系统结构的效率，节约开发人日成本：
    \begin{itemize}
    \item { 好的结构能够降低故障和线上bug出现的可能性，使得团队多数时间在处理重要且不紧急的工作； }
    \item { 总结合适的设计模式快速满足常见需求； }
    \end{itemize}
  }
  \item {
    测量结果，快速试错
  }
  \end{enumerate}
\end{frame}

\begin{frame}{带团队常见问题}
  \begin{itemize}
    \item {技术规范意识不足}
    \item {统一的数据平台缺乏}
    \item {完成任务不等于获得了好的结果}
  \end{itemize}
\end{frame}

\end{CJK}
\end{document}
